<html>
    <head>
        <script>
            async function fetchAlbumsJSON() {
                const response = await fetch("http://localhost:8080/v1/albums");

                if (!response.ok) {
                    const message = 'An error has occured: ${response.status}';
                    throw new Error(message);
                }

                const albums = await response.json();
                return albums;
            }
            
            function getAlbums() {
                fetchAlbumsJSON().then(data => {
                    addTable(data[0]);
                    console.log(data);
                    var count = Object.keys(data).length;
                    alert(count);
                }).catch(error => {
                    alert(error.message);
                });
            }

            function addTable(text) {
                var table_json = document.getElementById("table_json");

                var table = document.createElement("table");
                var row = document.createElement("tr");

                var cell0 = document.createElement("td");
                var textCell0 = document.createTextNode(text.id);
                cell0.appendChild(textCell0);
                row.appendChild(cell0);
                
                var cell1 = document.createElement("td");
                var textCell1 = document.createTextNode(text.artist);
                cell1.appendChild(textCell1);
                row.appendChild(cell1);

                var cell2 = document.createElement("td");
                var textCell2 = document.createTextNode(text.title);
                cell2.appendChild(textCell2);
                row.appendChild(cell2);

                var cell3 = document.createElement("td");
                var textCell3 = document.createTextNode(text.price);
                cell3.appendChild(textCell3);
                row.appendChild(cell3);

                table.appendChild(row);
                table_json.appendChild(table);
            }
        </script>
    </head>
    <body>
        <button onclick="getAlbums()">Test get albums</button>
         <table>
    {{ range $album := .albums }}
        <tr>
            <td>{{ .ID }}</td>
            <td>{{ .Title }}</td>
            <td>{{ .Artist }}</td>
            <td>{{ .Price }}</td>
        </tr>
    {{ end }}
    </table>

    <div id="table_json"></div>
    </body>
</html>